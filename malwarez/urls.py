from django.conf.urls import patterns, include, url
from django.contrib.staticfiles.urls import staticfiles_urlpatterns
from socketio import sdjango
from web.api import EventResource, SummaryFeedResource, SummaryFeedByCountryCodeResource
from tastypie.api import Api

# Uncomment the next two lines to enable the admin:
# from django.contrib import admin
# admin.autodiscover()
sdjango.autodiscover()

v1_api = Api(api_name='v1')
v1_api.register(SummaryFeedResource())

urlpatterns = \
    patterns('',
             url(r'^$', 'web.views.index'),
             url(r'^test/$', 'web.views.test'),

             url(r'^socket\.io', include(sdjango.urls)),
             url(r'^api/', include(v1_api.urls)),

             url(r'^summary-country/(?P<countryCode>\w+)/$', 'web.views.getSummaryByCountry'),
             # TODO: be more specific country parameter should be only 3 char long
             url(r'^top/(?P<type>\w+)/(?P<country>\w+)/$', 'web.views.getTopFive'),
             url(r'^top/(?P<type>\w+)/$', 'web.views.getTopFive'),

             # url(r'^detail/(?P<type>\w+)/(?P<country>\w+)/(?P<data>\w+)/$', 'web.views.getDetail'),
             url(r'^detail/(?P<type>\w+)/(?P<data>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/$',
                 'web.views.getDetail'),
             url(r'^detail/(?P<type>\w+)/(?P<data>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/(?P<country>\w+)/$',
                 'web.views.getDetail'),

             url(r'filter/malware', 'web.views.getDiversityMalware'),
             url(r'filter/ip', 'web.views.getDiversityIP')
             )
urlpatterns += staticfiles_urlpatterns()
