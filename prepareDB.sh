#!/bin/bash
#
# This script creates a new database and user for that database to use.
# Please don't forget to update malwarez/settings.py file with output of this script.
#
root_username='root'

malwarez_hostname="localhost"
malwarez_database="tmp_malwarez"
malwarez_username="tmp_malwarez"
malwarez_password="<malwarez_password>"

# prepare sql to execute
SQL="create database ${malwarez_database};\
create user '${malwarez_username}'@'${malwarez_hostname}' IDENTIFIED BY '${malwarez_password}';\
GRANT ALL PRIVILEGES ON ${malwarez_database}.* TO '${malwarez_username}'@'${malwarez_hostname}';\
FLUSH PRIVILEGES;"

# echo ${SQL}

# Execute query with root user. password will be asked before exevution
echo "Please enter password for mysql root user"
mysql -u${root_username} -p -e "${SQL}"

# Print the settings.py content
echo "Please update your malwarez/settings.py file with following code;"
echo "\
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': '${malwarez_database}', 
        'USER': '${malwarez_username}',
        'PASSWORD': '${malwarez_password}',
        'HOST': '${malwarez_hostname}',
        'PORT': '3306',
    }
}

After update please run following command:
./manage.py syncdb
";

