#! /usr/bin/python
# -- coding: utf-8 --

from random import randrange
from sys import stdout
import time


def random_ip():
    return "%d.%d.%d.%d" % (randrange(0, 255, 1), randrange(0, 255, 1), randrange(0, 255, 1), randrange(0, 255, 1))


def random_port():
    return randrange(0, 65535, 1)


def prepare_data():
    _data = '{"url": "http://%s:%d/asinq", "daddr": "%s", "saddr": "%s", "dport": "%d", "sport": "%d", ' \
            '"sha512": "a77687f49dff9baf425048e97931de39fc799efdad759d514bcf359e29106cbd6a6bf5aac5d9130d03f' \
            '9d5dba352110f623c166c31f6ef7a21557acf6a4aa52b", ' \
            '"md5": "78c9042bbcefd65beaa0d40386da9f89"}'
    src_ip = random_ip()
    src_port = random_port()
    dst_ip = random_ip()
    dst_port = random_port()
    return _data % (src_ip, src_port, dst_ip, src_ip, dst_port, src_port)


if __name__ == '__main__':

    while True:
        data = prepare_data()
        print data
        stdout.flush()
        time.sleep(float(randrange(25, 100)) / 100)