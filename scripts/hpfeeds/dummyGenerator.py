#! /usr/bin/python
# -- coding: utf-8 --

from random import randrange
from sys import stdout
import time


def randIP():
    return "%d.%d.%d.%d" % (randrange(0, 255, 1), randrange(0, 255, 1), randrange(0, 255, 1), randrange(0, 255, 1))


def randPort():
    return randrange(0, 65535, 1)


def prepareData():
    data = '{"url": "http://%s:%d/asinq", "daddr": "%s", "saddr": "%s", "dport": "%d", "sport": "%d", ' \
           '"sha512": "a77687f49dff9baf425048e97931de39fc799efdad759d514bcf359e29106cbd6a6bf5aac5d9130d03f' \
           '9d5dba352110f623c166c31f6ef7a21557acf6a4aa52b", ' \
           '"md5": "78c9042bbcefd65beaa0d40386da9f89"}'
    srcIP = randIP()
    sPort = randPort()
    dstIP = randIP()
    dPort = randPort()
    return data % (srcIP, sPort, dstIP, srcIP, dPort, sPort)


if __name__ == '__main__':

    while True:
        data = prepareData()
        print data
        stdout.flush()
        time.sleep(float(randrange(25, 100)) / 100)